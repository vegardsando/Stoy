Analytics.ReportWidget=Garnish.Base.extend({requestData:null,$grid:null,init:function(e,t){this.$element=$("#"+e),this.$title=$(".title",this.$element),this.$body=$(".body",this.$element),this.$date=$(".date",this.$element),this.$spinner=$(".spinner",this.$element),this.$spinner.removeClass("body-loading"),this.$error=$(".error",this.$element),Garnish.$doc.ready($.proxy(function(){this.$grid=$("#main > .grid")},this)),this.chartRequest=t.request,"undefined"!=typeof this.chartRequest&&(this.requestData=this.chartRequest),this.chartResponse=t.cachedResponse,"undefined"!=typeof this.chartResponse?this.parseResponse(this.chartResponse):this.requestData&&(this.chartResponse=this.sendRequest(this.requestData))},sendRequest:function(e){this.$spinner.removeClass("hidden"),$(".chart",this.$body).remove(),this.$error.addClass("hidden"),Craft.postActionRequest("analytics/reports/getChartReport",e,$.proxy(function(e,t){if(this.$spinner.addClass("hidden"),"success"==t&&"undefined"==typeof e.error)this.parseResponse(e);else{var s="An unknown error occured.";"undefined"!=typeof e&&e&&"undefined"!=typeof e.error&&(s=e.error),this.$error.html(s),this.$error.removeClass("hidden")}},this))},parseResponse:function(e){this.$spinner.addClass("hidden"),$chart=$('<div class="chart"></div>'),$chart.appendTo(this.$body),this.$title.html(e.metric),this.$date.html(e.periodLabel),this.chart=new Analytics.Chart($chart,e)}});